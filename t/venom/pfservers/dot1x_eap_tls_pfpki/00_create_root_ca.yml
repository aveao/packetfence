name: Create Inverse Root Certificate authority
version: 2
testcases:
- name: create_root_ca
  steps:
  - type: http
    method: POST
    url: '{{.pfserver_webadmin_url}}/api/v1/pki/cas'
    ignore_verify_ssl: true
    body: >-
      {
        "cn": "{{.dot1x_eap_tls_pfpki.certs.ca.cn}}",
        "mail": "pki@inverse.ca",
        "organisation": "{{.dot1x_eap_tls_pfpki.certs.ca.organisation}",
        "country": "{{.dot1x_eap_tls_pfpki.certs.ca.country}}",
        "state": "{{.dot1x_eap_tls_pfpki.certs.ca.state}}",
        "locality": "{{.dot1x_eap_tls_pfpki.certs.ca.locality}}",
        "street_address": "{{.dot1x_eap_tls_pfpki.certs.ca.street_address}}",
        "postal_code": "{{.dot1x_eap_tls_pfpki.certs.ca.postal_code}}",
        "key_type": "1",
        "digest": "4",
        "key_usage": "",
        "extended_key_usage": "",
        "days": "750",
        "key_size": "2048"
      }
    headers:
      "Authorization": "{{.pfserver_token}}"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200
